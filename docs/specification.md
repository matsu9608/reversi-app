# リバーシウェブアプリケーション仕様書

## 概要
本ドキュメントでは、リバーシ(オセロ)ウェブアプリケーションの主要機能とシステム構成について説明します。本アプリケーションはNode.jsとTypeScriptで実装されており、ブラウザから対戦を行い履歴を確認することができます。

## 主要機能
- 対戦開始および盤面表示
- 石を打つ操作とルール判定
- 勝敗の自動判定と結果保存
- 過去の対戦結果の一覧表示
- **直前の手を取り消す機能**

## システム構成
アプリケーションはクリーンアーキテクチャに基づいて実装されており、プレゼンテーション層・アプリケーション層・ドメイン層・インフラストラクチャ層に分割されています。MySQLをデータベースとし、`express` を用いたAPIサーバーからフロントエンドへJSON形式でデータを提供します。

## Web API
主なエンドポイントは以下の通りです。

| メソッド | パス | 内容 |
| --- | --- | --- |
| `POST` | `/api/games` | 新しい対戦を開始する |
| `GET` | `/api/games/latest/boards/latest` | 最新ターンの盤面を取得する |
| `POST` | `/api/games/latest/turns` | 石を打つ |
| `DELETE` | `/api/games/latest/turns/latest` | 直前のターンを取り消す |

詳細な仕様は `docs/openapi.yml` を参照してください。

## データ永続化
ゲーム、ターン、ゲーム結果はそれぞれリポジトリを介してMySQLに保存されます。削除操作を伴うUndo機能では直前のターン情報と該当するゲーム結果を削除することで状態を巻き戻します。

## クライアント
クライアントは静的HTMLとJavaScriptで構成され、APIを呼び出して盤面描画やユーザー入力を処理します。UndoボタンなどのUI操作は `static/game/main.js` から行います。

## 今後の拡張案
- オンライン対戦機能
- AIプレイヤーとの対戦
- 統計情報の表示など分析機能

